<% if @user.banner.attached? %>
  <section class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= cl_image_path @user.banner.key, height: 300, crop: :fill %>)">
  <%= cl_image_path @user.banner.key, height: 300, crop: :fill, class: "banner style: background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)" %>
<% else  %>
  <section class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= src="http://source.unsplash.com/featured/?nature" %>)">
<% end %>

  <div class="container">
    <%# ! Anything in the banner? %>
  </div>
</section>

<div class="row">
  <div class="col-md-4 profile-elements position-relative">
    <section class="d-flex flex-column justify-content-center align-items-center profile-content">
      <%# TODO: Profile pic %>
      <div class="profile-pic">
      <% if @user.photo.attached? %>
        <%= cl_image_tag @user.photo.key, height: 300, width: 400, crop: :fill %>
      <% else %>
        <%= image_tag "http://source.unsplash.com/featured/?people" %>
    <% end %>
        <%# TODO: Add friend button %>

        <% if @user == current_user %>
          <a href="" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><i class="fa-solid fa-pen-to-square text-center fs-5 add-friend"></i></a>
        <% else %>
          <a href="" data-bs-toggle="modal"><i class="fa-solid fa-user-plus text-center fs-5 add-friend"></i></a>
        <% end %>

      </div>
      <article class="bio text-center">
        <%# TODO: Name %>
        <p class="fs-5 fw-bold"><%= "#{@user.first_name.capitalize} #{@user.last_name.capitalize}" %></p>
        <p class="fs-6 fst-italic mb-3"><%= "##{@user.nickname}" %></p>
        <%# TODO: Bio / About me %>
        <%= @user.bio %>
      </article>
      <%# TODO: Send a message / Edit profile %>
      <article>
        <% unless policy(@user).edit? %>
          <%= link_to "Message", "#", class: "custom-btn btn-purple text-center text-decoration-none mt-2" %>
        <% end %>
      </article>
    </section>
  </div>

  <div class="col-md-6">
    <%# ! SECOND COLUMN %>

    <div class="posts my-4 ms-5">
      <%= render "shared/posts", locals: {p: @post} %>
    </div>

  </div>

  <div class="col-md-2">
    <%# ! THIRD COLUMN (FOR MAP) %>
  </div>

</div>


<!-- MAP HERE
<div><%= @user.interests %></div>
=======
<div style="width: 100%; height: 600px;"
  data-controller="map"
  data-map-markers-value="<%= @markers.to_json %>"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
</div>
-->


<!-- Modal -->

<div class="modal fade" id="staticBackdrop" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header d-flex justify-content-center">
        <p class="fs-3 text-center fw-bold">Update profile</p>
      </div>
      <div class="modal-body">
        <main class="user-form my-3">
          <%= simple_form_for @user, url: user_profile_path(@user) do |f| %>
          <%= f.input :first_name %>
          <%= f.input :last_name %>
          <%= f.input :nickname %>
          <%= f.input :bio, as: :text %>
          <%= f.input :photo, as: :file %>
          <%= f.input :banner, as: :file %>
        </main>
      </div>
      <div class="modal-footer">
        <button type="submit" class="custom-btn btn-purple w-100 fw-bold" style="z-index: 1;">Update!</button>
          <% end %>
      </div>
    </div>
  </div>
</div>
